/*
 jPaq - A fully customizable JavaScript/JScript library
 http://jpaq.org/

 Copyright (c) 2011 Christopher West
 Licensed under the MIT license.
 http://jpaq.org/license/

 Version: 1.0.6.$$$$$
 Revised: April 6, 2011
*/
(function(){function o(a,d){a._=function(a){if(l===a)return d}}function j(a){if(!a||!isFinite(a.length||"a")||a.length<0)return[];try{return Array.prototype.slice.call(a)}catch(d){for(var c=[],e=a.length-1;e>=0;e--)c[e]=a[e];return c}}function m(a){var d=new Date(a.getFullYear()+1,0,4);if((d-a)/864E5<7&&(a.getDay()+6)%7<(d.getDay()+6)%7)return d.getFullYear();if(a.getMonth()>0||a.getDate()>=4)return a.getFullYear();return a.getFullYear()-((a.getDay()+6)%7-a.getDate()>2?1:0)}var l={};jPaq={extend:function(a,
d,c){typeof c!="function"&&(c=function(){return!0});for(var e in d)c(d[e],e,a[e],a)&&(a[e]=d[e])},parseArray:j,GET:0,escape:function(a,d){return encodeURIComponent(a).replace(/[\u0027-\u002A]/g,function(a){return"%"+a.charCodeAt(0).toString(16)}).replace(/%20/g,d?"+":"%20")},unescape:function(a,d){return decodeURIComponent(a.replace(/\+/g,d?"%20":"+"))},toString:function(){return"jPaq - A fully customizable JavaScript/JScript library created by Christopher West."}};(function(){for(var a={},d=location.search.substring(1).split("&"),
c,e=0,f=d.length;e<f;e++)if((c=d[e].match(/^(.*?)=(.*)$/))&&!(c.length<3))c[2]=jPaq.unescape(c[2],!0),(c[1]=jPaq.unescape(c[1],!0))in a?a[c[1]]instanceof Array?a[c[1]].push(c[2]):a[c[1]]=[a[c[1]],c[2]]:a[c[1]]=c[2];jPaq.GET=a})();Object.keys=Object.keys||function(a){var d=[],c;for(c in a)a.hasOwnProperty(c)&&d.push(c);return d};Array.range=function(a,d,c){arguments.length==1&&(d=a,a=0);for(var e=[],f=(c=c||1)<0;f?a>d:a<d;a+=c)e.push(a);return e};Array.prototype.uniquify=function(){for(var a=this.slice(0),
d=0,c=a.length,e=c-1;d<e;d++)for(var f=d+1;f<c;f++)a[d]===a[f]&&(a.splice(f--,1),c=e--);return a};Array.prototype.clone=function(){return this.slice(0)};Array.prototype.subtract=function(a){if(!(a instanceof Array))return[];for(var d,c=0,e=[],f=[];c<this.length;c++){for(d=0;d<a.length;d++)if(f[d]!=!0&&a[d]===this[c]){f[d]=!0;break}d==a.length&&e.push(this[c])}return e};Array.prototype.intersect=function(a){if(!(a instanceof Array))return[];return this.subtract(this.subtract(a))};Array.prototype.union=
function(a){if(!(a instanceof Array))return[];return this.concat(a.subtract(this))};Function.prototype.curry=function(){var a=this,d=j(arguments);return function(){return a.apply(this,d.concat(j(arguments)))}};Array.prototype.every=Array.prototype.every||function(a,d){if(typeof a!="function")throw new TypeError;for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&!a.call(d,this[c],c,this))return!1;return!0};Array.prototype.forEach=Array.prototype.forEach||function(a,d){if(typeof a!="function")throw new TypeError;
for(var c=0,e=this.length>>>0;c<e;c++)c in this&&a.call(d,this[c],c,this)};Array.prototype.filter=Array.prototype.filter||function(a,d){if(typeof a!="function")throw new TypeError;for(var c,e=[],f=0,h=this.length>>>0;f<h;f++)f in this&&a.call(d,c=this[f],f,this)&&e.push(c);return e};Array.prototype.indexOf=Array.prototype.indexOf||function(a,d){var c=this.length>>>0,d=Number(d)||0;if((d=d<0?Math.ceil(d):Math.floor(d))<0)d+=c;for(;d<c;d++)if(d in this&&this[d]===a)return d;return-1};Array.prototype.lastIndexOf=
Array.prototype.lastIndexOf||function(a,d){for(var c=this.length,d=isNaN(d=Number(d))?c-1:(d=d<0?Math.ceil(d):Math.floor(d))<0?d+c:d>=c?c-1:d;d>-1;d--)if(d in this&&this[d]===a)return d;return-1};Array.prototype.map=Array.prototype.map||function(a,d){if(typeof a!="function")throw new TypeError;for(var c=this.length>>>0,e=Array(c),f=0;f<c;f++)f in this&&(e[f]=a.call(d,this[f],f,this));return e};Array.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};Array.prototype.reduce=
Array.prototype.reduce||function(a,d){if(typeof a!="function")throw new TypeError;var c=this.length>>>0,e=arguments.length;if(c==0&&e==1)throw new TypeError;var f=0;if(e<2){do{if(f in this){d=this[f++];break}if(++f>=c)throw new TypeError;}while(1)}for(;f<c;f++)f in this&&(d=a.call(void 0,d,this[f],f,this));return d};Array.prototype.reduceRight=Array.prototype.reduceRight||function(a,d){if(typeof a!="function")throw new TypeError;var c=this.length>>>0,e=arguments.length;if(c==0&&e==1)throw new TypeError;
c-=1;if(e<2){do{if(c in this){d=this[c--];break}if(--c<0)throw new TypeError;}while(1)}for(;c>=0;c--)c in this&&(d=a.call(void 0,d,this[c],c,this));return d};Array.prototype.some=Array.prototype.some||function(a,d){if(typeof a!="function")throw new TypeError;for(var c=0,e=this.length>>>0;c<e;c++)if(c in this&&a.call(d,this[c],c,this))return!0;return!1};(Color=function(){o(this,{r:0,g:0,b:0});this.setTo.apply(this,arguments)}).prototype={setTo:function(a,d,c){if(arguments.length==1){var e=/^#?(([\dA-F]{3}){1,2})$/i.exec(a+
"");e?(e=e[1],e.length==3&&(e=e.replace(/(.)/g,"$1$1")),this.r(parseInt(e.substring(0,2),16)).g(parseInt(e.substring(2,4),16)).b(parseInt(e.substring(4,6),16))):(e=/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i.exec(a+""))?this.r(e[1]).g(e[2]).b(e[3]):this.r(a)}else this.r(a).g(d).b(c);return this},getHexCode:function(){return"#"+[this.r().toString(16),this.g().toString(16),this.b().toString(16)].join(",").replace(/\b(\w)\b/gi,"0$1").toUpperCase().replace(/,/g,"")},combine:function(a,d){if(isNaN(d=
+d))d=50;var c=Math.max(Math.min(d,100),0)/100,e=1-c;return new Color(this.r()*e+a.r()*c,this.g()*e+a.g()*c,this.b()*e+a.b()*c)},getSafeColor:function(){var a=this.getLuminance()<128?255:0;return new Color(a,a,a)},getLuminance:function(){with(this)return 0.299*r()+0.587*g()+0.114*b()},toGrayscale:function(){var a=Math.round(this.getLuminance());return new Color(a,a,a)},getOpposite:function(){with(this)return new Color(255-r(),255-g(),255-b())},getLighter:function(a){return this.combine(p,a!=null?
a>>>0:30)},getDarker:function(a){return this.combine(q,a!=null?a>>>0:30)}};for(var s=["r","g","b"],k=0;k<3;k++)(function(a){Color.prototype[a]=function(d){var c=this._(l);if(!arguments.length)return c[a];c[a]=Math.min(Math.max(d>>>0,0),255);return this}})(s[k]);var q=new Color,p=new Color(255,255,255);Color.prototype.toString=Color.prototype.getHexCode;Color.random=function(a,d,c){for(var a=[[a||0,0],[d||0,1],[c||0,2]].sort(function(a,c){return a[0]<=c[0]?a[0]<c[0]?-1:0:1}),d=[],e,f,c=0;c<3;c++)if(a[c][0]instanceof
Array)d[a[c][1]]=a[c][0].length==1?a[c][0][0]:Math.randomIn.apply(null,a[c][0]);else{if(a[c][0]!=e||e==0)f=Math.round(Math.randomIn(e>0?f:0,255));e=a[c][0];d[a[c][1]]=f}return new Color(d[0],d[1],d[2])};Math.randomIn=function(a,d){a=a==null?0:a;return Math.random()*((d==null?1:d)-a)+a};RegExp.fromWildExp=function(a,d){for(var c=d&&d.indexOf("o")>-1,e,f,h="",i=d&&d.indexOf("l")>-1?"":"?",j=RegExp("~.|\\[!|"+(c?"{\\d+,?\\d*\\}|[":"[")+(d&&d.indexOf("p")>-1?"":"\\(\\)")+"\\{\\}\\\\\\.\\*\\+\\?\\:\\|\\^\\$%_#<>]");(e=
a.search(j))>-1&&e<a.length;)h+=a.substring(0,e),h+=(f=a.match(j)[0])=="[!"?"[^":f.charAt(0)=="~"?"\\"+f.charAt(1):f=="*"||f=="%"?".*"+i:f=="?"||f=="_"?".":f=="#"?"\\d":c&&f.charAt(0)=="{"?f+i:f=="<"?"\\b(?=\\w)":f==">"?"(?:\\b$|(?=\\W)\\b)":"\\"+f,a=a.substring(e+f.length);h+=a;d&&(/[ab]/.test(d)&&(h="^"+h),/[ae]/.test(d)&&(h+="$"));return RegExp(h,d?d.replace(/[^gim]/g,""):"")};String.prototype.findPattern=function(a,d){var c=this.match(RegExp.fromWildExp(a,d));return c!=null&&(d||"").indexOf("g")<
0?c[0]:c};String.prototype.indexOfPattern=function(a,d){var c=[];this.replace(RegExp.fromWildExp(a,d),function(){c.push(arguments[arguments.length-2])});return(d||"").indexOf("g")<0||!c.length?c[0]||null:c};String.prototype.replacePattern=function(a,d,c){return this.replace.apply(this,[RegExp.fromWildExp(a,d),c])};String.prototype.trim=String.prototype.trim||function(){return this.trimLeft().trimRight()};String.prototype.trimLeft=String.prototype.trimLeft||function(){return this.replace(/^[\s\u00A0]+/,
"")};String.prototype.trimRight=String.prototype.trimRight||function(){return this.replace(/[\s\u00A0]+$/,"")};String.prototype.padLeft=function(a,d){if(!d||d.constructor!==String)d=" ";return Array(Math.max(Math.ceil((a-this.length)/d.length),0)+1).join(d).slice(this.length-a)+this};String.prototype.padRight=function(a,d){if(!d||d.constructor!==String)d=" ";return this+Array(Math.max(Math.ceil((a-this.length)/d.length),0)+1).join(d).slice(0,a-this.length)};String.prototype.padCenter=function(a,d,
c){if(!d||d.constructor!==String)d=" ";return this.padLeft(Math[c?"ceil":"floor"]((this.length+a)/2),d).padRight(a,d)};var i=document.createElement("DIV"),n="innerText"in i?"innerText":"textContent";String.prototype.toHTML=function(){i[n]=this;return i.innerHTML.replace(/  /g," &nbsp;")};String.prototype.fromHTML=function(){i.innerHTML=this;return i[n]};String.prototype.tag=function(a,d){var c=[a],e;for(e in d||{})c.push(e+'="'+d[e].replace(/"/g,"&quot;")+'"');return"<"+c.join(" ")+">"+this.toHTML()+
"</"+a+">"};String.prototype.toProperCase=function(){return this.replace(/(^|[\u00A0\s])\S/g,function(a){return a.toUpperCase()})};String.prototype.compareTo=function(a,d){var c=!d?this.toUpperCase():this,a=!d?(a+"").toUpperCase():a+"";return c<a?-1:c>a?1:0};var t="Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),u="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),v="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),w="January,February,March,April,May,June,July,August,September,October,November,December".split(",");
Date.prototype.format=function(a){if(typeof a!=="string"||/^\s*$/.test(a))return this+"";var d=new Date(this.getFullYear(),0,1),c=this;return a.replace(/[dDjlNSwzWFmMntLoYyaABgGhHisu]/g,function(a){switch(a){case "d":return("0"+c.getDate()).replace(/^.+(..)$/,"$1");case "D":return t[c.getDay()];case "j":return c.getDate();case "l":return u[c.getDay()];case "N":return(c.getDay()+6)%7+1;case "S":return a=c.getDate(),(a=Math.abs(a)%100)%10==1&&a!=11?"st":a%10==2&&a!=12?"nd":a%10==3&&a!=13?"rd":"th";
case "w":return c.getDay();case "z":return Math.ceil((d-c)/864E5);case "W":return a=new Date(m(c),0,4),a.setDate(a.getDate()-(a.getDay()+6)%7),("0"+(parseInt((c-a)/6048E5)+1)).replace(/^.(..)$/,"$1");case "F":return w[c.getMonth()];case "m":return("0"+(c.getMonth()+1)).replace(/^.+(..)$/,"$1");case "M":return v[c.getMonth()];case "n":return c.getMonth()+1;case "t":return(new Date(c.getFullYear(),c.getMonth()+1,-1)).getDate();case "L":return(new Date(c.getFullYear(),1,29)).getDate()==29?1:0;case "o":return m(c);
case "Y":return c.getFullYear();case "y":return(c.getFullYear()+"").replace(/^.+(..)$/,"$1");case "a":return c.getHours()<12?"am":"pm";case "A":return c.getHours()<12?"AM":"PM";case "B":return Math.floor(((c.getUTCHours()+1)%24+c.getUTCMinutes()/60+c.getUTCSeconds()/3600)*1E3/24);case "g":return c.getHours()%12!=0?c.getHours()%12:12;case "G":return c.getHours();case "h":return("0"+(c.getHours()%12!=0?c.getHours()%12:12)).replace(/^.+(..)$/,"$1");case "H":return("0"+c.getHours()).replace(/^.+(..)$/,
"$1");case "i":return("0"+c.getMinutes()).replace(/^.+(..)$/,"$1");case "s":return("0"+c.getSeconds()).replace(/^.+(..)$/,"$1");case "u":return c.getMilliseconds()}})}})();
